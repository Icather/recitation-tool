<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>文言文背诵助手</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div class="app-container">
        <!-- 顶部导航栏 -->
        <header class="app-header">
            <button id="sidebar-toggle" class="sidebar-toggle-btn" aria-label="打开菜单">
                <span></span>
                <span></span>
                <span></span>
            </button>
            <div class="logo">
                <h1>你就背吧</h1>
            </div>
            <div class="mode-switch-container">
                <div class="mode-switch">
                    <span class="mode-label">复习模式</span>
                    <label class="switch">
                        <input type="checkbox" id="mode-toggle">
                        <span class="slider round"></span>
                    </label>
                    <span class="mode-label">背诵模式</span>
                </div>
            </div>
            <div class="header-actions">
                <a href="intro.html" class="icon-link" title="项目介绍">
                    <svg viewBox="0 0 24 24" width="24" height="24" stroke="currentColor" stroke-width="2" fill="none">
                        <circle cx="12" cy="12" r="10"></circle>
                        <line x1="12" y1="16" x2="12" y2="12"></line>
                        <line x1="12" y1="8" x2="12.01" y2="8"></line>
                    </svg>
                </a>
            </div>
        </header>

        <!-- 侧边栏遮罩层 -->
        <div id="sidebar-overlay" class="sidebar-overlay"></div>

        <div class="main-layout">
            <!-- 左侧边栏：篇目列表 -->
            <aside class="sidebar">
                <div class="sidebar-header">
                    <h3>篇目列表</h3>
                </div>
                <div class="sidebar-content">
                    <div id="texts-list-view" class="content-view active">
                        <!-- 册次选择器将插入在这里 -->
                        <ul id="texts-list-ul">
                            <!-- 通过JavaScript动态填充 -->
                        </ul>
                    </div>
                    <div id="paragraphs-list-view" class="content-view">
                        <div class="paragraphs-header">
                            <button id="back-to-texts" class="icon-btn">
                                <svg viewBox="0 0 24 24" width="18" height="18" stroke="currentColor" stroke-width="2"
                                    fill="none">
                                    <path d="M19 12H5M12 19l-7-7 7-7" />
                                </svg>
                                返回
                            </button>
                            <span id="current-text-title">选择段落</span>
                        </div>
                        <div id="paragraphs-container">
                            <!-- 段落列表 -->
                        </div>
                    </div>
                </div>
            </aside>

            <!-- 主内容区 -->
            <main class="content-area">
                <!-- 背诵模式界面 -->
                <div id="recitation-mode" class="mode-content">

                    <!-- 工具栏 -->
                    <div class="toolbar">
                        <div class="toolbar-group">
                            <div class="tool-item" title="常规挖空">
                                <input type="checkbox" id="regular-mode" checked>
                                <label for="regular-mode">常规</label>
                            </div>
                            <div class="tool-item inputs slider-group">
                                <label>间隔</label>
                                <input type="number" id="interval" min="1" value="3">
                                <div class="slider-container">
                                    <input type="range" id="interval-slider" min="1" max="20" value="3">
                                </div>
                                <div class="slider-range-labels">
                                    <span class="min-label">1</span>
                                    <span class="max-label">20</span>
                                </div>
                            </div>
                            <div class="tool-item inputs slider-group">
                                <label>起始</label>
                                <input type="number" id="start" min="0" value="1">
                                <div class="slider-container">
                                    <input type="range" id="start-slider" min="0" max="10" value="1">
                                </div>
                                <div class="slider-range-labels">
                                    <span class="min-label">0</span>
                                    <span class="max-label">10</span>
                                </div>
                            </div>
                        </div>

                        <div class="toolbar-divider"></div>

                        <div class="toolbar-group">
                            <div class="tool-item" title="随机挖空">
                                <input type="checkbox" id="random-mode">
                                <label for="random-mode">随机</label>
                            </div>
                            <div class="tool-item inputs slider-group">
                                <label>频率%</label>
                                <input type="number" id="random-ratio" min="1" max="100" value="30">
                                <div class="slider-container">
                                    <input type="range" id="random-ratio-slider" min="1" max="100" value="30">
                                </div>
                                <div class="slider-range-labels">
                                    <span class="min-label">1%</span>
                                    <span class="max-label">100%</span>
                                </div>
                            </div>
                        </div>

                        <div class="toolbar-divider"></div>

                        <div class="toolbar-group">
                            <div class="tool-item" title="仅显示句首字">
                                <input type="checkbox" id="first-char-mode">
                                <label for="first-char-mode">首字</label>
                            </div>
                        </div>

                        <div class="toolbar-spacer"></div>

                        <!-- 编辑/背诵 切换按钮 -->
                        <div class="view-toggle">
                            <button id="btn-edit-view" class="toggle-btn active">
                                <svg viewBox="0 0 24 24" width="16" height="16" stroke="currentColor" stroke-width="2"
                                    fill="none">
                                    <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                                    <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                                </svg>
                                编辑
                            </button>
                            <button id="btn-recite-view" class="toggle-btn">
                                <svg viewBox="0 0 24 24" width="16" height="16" stroke="currentColor" stroke-width="2"
                                    fill="none">
                                    <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path>
                                    <path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path>
                                </svg>
                                背诵
                            </button>
                        </div>
                    </div>

                    <!-- 编辑器/展示区 (Single Box) -->
                    <div class="editor-container">
                        <div id="edit-layer" class="layer active">
                            <textarea id="input-text" placeholder="在此输入或从左侧选择文言文..."></textarea>
                            <div class="layer-hint">编辑模式</div>
                        </div>
                        <div id="recite-layer" class="layer">
                            <textarea id="output-text" readonly placeholder="点击“背诵”按钮生成挖空文本..."></textarea>
                            <div class="layer-hint">背诵模式</div>
                        </div>
                    </div>

                    <!-- 移动端处理按钮 (桌面端通过切换视图自动处理) -->
                    <button id="process-btn" class="mobile-fab">
                        <svg viewBox="0 0 24 24" width="24" height="24" stroke="currentColor" stroke-width="2"
                            fill="none">
                            <polyline points="20 6 9 17 4 12"></polyline>
                        </svg>
                    </button>
                </div>

                <!-- 复习模式界面 -->
                <div id="review-mode" class="mode-content active">
                    <div class="review-container">
                        <div class="review-header">
                            <h2>智能复习</h2>
                            <p>系统将随机抽取句子进行挖空测试</p>
                        </div>

                        <div class="review-controls">
                            <div class="combo-control" id="hide-info-control">
                                <div class="combo-main" id="hide-info-toggle-btn" role="button" tabindex="0">
                                    <div class="custom-checkbox">
                                        <svg viewBox="0 0 24 24" width="12" height="12" stroke="currentColor"
                                            stroke-width="4" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                            <polyline points="20 6 9 17 4 12"></polyline>
                                        </svg>
                                    </div>
                                    <span class="combo-label">隐藏篇目/作者/朝代</span>
                                </div>
                                <div class="combo-separator"></div>
                                <div class="combo-trigger" id="hide-dropdown-trigger" role="button" tabindex="0">
                                    <svg viewBox="0 0 24 24" width="16" height="16" stroke="currentColor"
                                        stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                        <polyline points="6 9 12 15 18 9"></polyline>
                                    </svg>
                                </div>
                                <div class="combo-dropdown" id="hide-dropdown-menu">
                                    <label class="dropdown-item">
                                        <input type="checkbox" id="hide-title-check" checked>
                                        <span>篇目名</span>
                                    </label>
                                    <label class="dropdown-item">
                                        <input type="checkbox" id="hide-dynasty-check" checked>
                                        <span>朝代</span>
                                    </label>
                                    <label class="dropdown-item">
                                        <input type="checkbox" id="hide-author-check" checked>
                                        <span>作者</span>
                                    </label>
                                </div>
                            </div>
                            <button id="view-unknown-cards-btn" class="btn-secondary">
                                <svg viewBox="0 0 24 24" width="18" height="18" stroke="currentColor" stroke-width="2"
                                    fill="none">
                                    <path d="M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"></path>
                                </svg>
                                查看生疏本
                            </button>
                            <button id="generate-review" class="btn-primary">
                                <svg viewBox="0 0 24 24" width="18" height="18" stroke="currentColor" stroke-width="2"
                                    fill="none">
                                    <path d="M23 4v6h-6"></path>
                                    <path d="M1 20v-6h6"></path>
                                    <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15">
                                    </path>
                                </svg>
                                生成新题目
                            </button>
                        </div>

                        <div id="review-content" class="review-content hidden">
                            <div id="review-sentences" class="review-sentences">
                                <!-- 复习句子将在这里动态生成 -->
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- 生疏本模态窗口 -->
    <div id="unknown-cards-modal" class="modal-overlay hidden">
        <div class="modal-container">
            <div class="modal-header">
                <h3>生疏本</h3>
                <div class="modal-header-actions">
                    <button id="clear-storage-btn" class="btn-clear-storage" title="清空存储">
                        <svg viewBox="0 0 24 24" width="18" height="18" stroke="currentColor" stroke-width="2"
                            fill="none">
                            <polyline points="3 6 5 6 21 6"></polyline>
                            <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2">
                            </path>
                        </svg>
                        清空存储
                    </button>
                    <button id="close-modal-btn" class="icon-btn close-btn">
                        <svg viewBox="0 0 24 24" width="24" height="24" stroke="currentColor" stroke-width="2"
                            fill="none">
                            <line x1="18" y1="6" x2="6" y2="18"></line>
                            <line x1="6" y1="6" x2="18" y2="18"></line>
                        </svg>
                    </button>
                </div>
            </div>
            <div class="modal-body">
                <div class="unknown-cards-sidebar">
                    <ul id="unknown-source-list">
                        <!-- 动态生成的篇目列表 -->
                    </ul>
                </div>
                <div class="unknown-cards-content">
                    <div id="unknown-cards-container">
                        <!-- 动态生成的卡片列表 -->
                        <div class="empty-state">
                            <svg viewBox="0 0 24 24" width="48" height="48" stroke="currentColor" stroke-width="1"
                                fill="none">
                                <path d="M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"></path>
                            </svg>
                            <p>还没有标记任何生疏句子</p>
                            <p class="sub-text">在复习模式中点击 ❤️ 即可添加</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 隐藏的旧结构，用于保持JS兼容性，稍后会清理JS -->
    <div style="display:none;">
        <div class="classic-texts-section"></div>
    </div>

    <script src="classic_texts_final.js"></script>
    <script src="script.js"></script>
</body>

</html>