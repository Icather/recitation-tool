# 完善文本数据与升级隐藏功能实现计划

## 一、文本数据完善

### 1. 数据结构升级

* 在 `classic_texts_final.js` 中为每篇文本添加 `source`（出处）和 `dynasty`（朝代）字段

* 确保每篇文本包含完整的四个核心字段：`title`（标题）、`source`（出处）、`author`（作者）、`dynasty`（朝代）

### 2. 数据填充规则

* **出处**：严格参照上海市普通高中教科书标准填写，未收录内容留空

* **朝代**：根据作者所处朝代填写，现代作品填“现代”

* **作者**：保持现有数据不变，未知作者填写"未知"

* **标题**：保持现有数据不变

## 二、隐藏功能升级

### 1. 功能名称变更

* 将"隐藏作者/朝代"功能更名为"隐藏作者/朝代/篇名"

* 更新对应的 HTML 元素 `id` 和文本内容

### 2. 功能逻辑扩展

* 修改 `script.js` 中的隐藏功能逻辑，支持对 `title`、`author`、`dynasty` 三个字段的随机隐藏

* 实现随机隐藏算法，可单独或组合隐藏三个字段

* 保持原有的复选框控制机制

## 三、前端渲染优化

### 1. 空值字段处理

* 在文本渲染时，检查 `source`、`author`、`dynasty` 字段是否为空

* 为空的字段不进行渲染，避免显示"未知"或空字符串

### 2. 隐藏功能集成

* 在复习模式中，根据隐藏功能的状态，随机隐藏文本的标题、作者或朝代

* 使用占位符（如"\_\_\_\_\_\_\_\_\_\_"）替换被隐藏的内容

* 确保隐藏状态在页面刷新或文本切换时保持一致

## 四、实现步骤

1. **修改数据文件**：更新 `classic_texts_final.js`，为每篇文本添加 `source` 和 `dynasty` 字段
2. **更新 HTML 元素**：修改功能名称和对应的 `id`
3. **升级 JavaScript 逻辑**：

   * 修改隐藏功能的名称和描述

   * 扩展隐藏逻辑，支持标题隐藏

   * 实现随机隐藏算法
4. **优化前端渲染**：

   * 添加空值字段检查

   * 集成隐藏功能到文本渲染流程
5. **测试验证**：

   * 验证数据完整性

   * 测试隐藏功能的各种组合

   * 检查前端渲染效果

   * 确保响应式设计正常

## 五、预期效果

* 每篇文本都包含完整的四个核心信息字段

* 空值字段在前端不显示

* 复习模式中可随机隐藏标题、作者或朝代

* 功能名称和描述清晰准确

* 交互流畅，视觉效果一致

## 六、文件修改清单

* `classic_texts_final.js`：完善文本数据字段

* `script.js`：升级隐藏功能逻辑和前端渲染

* `index.html`：更新功能名称和描述

## 七、技术要点

* DOM 操作：动态更新文本内容和隐藏状态

* 随机算法：实现公平的随机隐藏机制

* 条件渲染：根据字段值和隐藏状态动态显示内容

* 数据完整性：确保所有文本都包含必要字段

* 向后兼容：保持现有功能正常运行

